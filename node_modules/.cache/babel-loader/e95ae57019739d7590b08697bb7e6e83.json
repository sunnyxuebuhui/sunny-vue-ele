{"remainingRequest":"/Users/chenyiquan/Vue/sunny-vue-ele/node_modules/babel-loader/lib/index.js!/Users/chenyiquan/Vue/sunny-vue-ele/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/chenyiquan/Vue/sunny-vue-ele/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/chenyiquan/Vue/sunny-vue-ele/src/views/index/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/chenyiquan/Vue/sunny-vue-ele/src/views/index/index.vue","mtime":1539933576154},{"path":"/Users/chenyiquan/Vue/sunny-vue-ele/node_modules/cache-loader/dist/cjs.js","mtime":1539661153075},{"path":"/Users/chenyiquan/Vue/sunny-vue-ele/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/chenyiquan/Vue/sunny-vue-ele/node_modules/cache-loader/dist/cjs.js","mtime":1539661153075},{"path":"/Users/chenyiquan/Vue/sunny-vue-ele/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _objectSpread from \"/Users/chenyiquan/Vue/sunny-vue-ele/node_modules/@babel/runtime/helpers/builtin/es6/objectSpread\";\nimport \"core-js/modules/es6.function.name\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"/Users/chenyiquan/Vue/sunny-vue-ele/node_modules/@babel/runtime/helpers/builtin/es6/asyncToGenerator\";\nimport \"core-js/modules/es6.array.iterator\";\nimport \"core-js/modules/es6.promise\";\nimport \"core-js/modules/es7.promise.finally\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { mapMutations } from 'vuex';\nimport HeadTop from '../../components/head.vue';\nimport FooterGuide from '../../components/footer.vue';\nimport ShopList from './shopList';\nimport { msiteAddress, msiteFoodTypes, cityGuess } from '../../service/getData';\nexport default {\n  components: {\n    HeadTop: HeadTop,\n    FooterGuide: FooterGuide,\n    ShopList: ShopList\n  },\n  data: function data() {\n    return {\n      headTitle: '请选择地址...',\n      // 标题\n      geohash: '',\n      // city页面传递过来的地址geohash\n      hasGetData: false,\n      //是否已经获取地理位置数据，成功之后再获取商铺列表信息\n      foodTypes: [],\n      // 食品分类列表\n      imgBaseUrl: 'https://fuss10.elemecdn.com' //图片域名地址\n\n    };\n  },\n  beforeMount: function () {\n    var _beforeMount = _asyncToGenerator(\n    /*#__PURE__*/\n    regeneratorRuntime.mark(function _callee() {\n      var address, _address, res;\n\n      return regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return cityGuess();\n\n            case 2:\n              address = _context.sent;\n\n              if (this.$route.query.geohash) {\n                _context.next = 10;\n                break;\n              }\n\n              _context.next = 6;\n              return cityGuess();\n\n            case 6:\n              _address = _context.sent;\n              this.geohash = \"\".concat(_address.latitude, \",\").concat(_address.longitude);\n              _context.next = 11;\n              break;\n\n            case 10:\n              this.geohash = this.$route.query.geohash;\n\n            case 11:\n              //保存geohash 到vuex\n              this.SAVE_GEOHASH(this.geohash); //获取位置信息\n\n              _context.next = 14;\n              return msiteAddress(this.geohash);\n\n            case 14:\n              res = _context.sent;\n              this.headTitle = res.name; // 记录当前经度纬度\n\n              this.RECORD_ADDRESS(res);\n              this.hasGetData = true;\n\n            case 18:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, this);\n    }));\n\n    return function beforeMount() {\n      return _beforeMount.apply(this, arguments);\n    };\n  }(),\n  mounted: function mounted() {\n    this._initGetFoodList();\n  },\n  methods: _objectSpread({\n    centerClick: function centerClick() {\n      this.$router.push({\n        name: 'city'\n      });\n    },\n    shopListLoaded: function shopListLoaded() {\n      var scrolls = this.$refs.scrollFood;\n      setTimeout(function () {\n        scrolls.refresh();\n      }, 20);\n    },\n    _initGetFoodList: function _initGetFoodList() {\n      var _this = this;\n\n      //获取导航食品类型列表\n      msiteFoodTypes(this.geohash).then(function (res) {\n        if (res.length >= 8) {\n          _this.foodTypes = res.slice(0, 8);\n        } else {\n          _this.foodTypes = res;\n        }\n      }).then(function () {});\n    }\n  }, mapMutations(['SAVE_GEOHASH', 'RECORD_ADDRESS']))\n};",{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAmBA,SAAA,YAAA,QAAA,MAAA;AACA,OAAA,OAAA,MAAA,2BAAA;AACA,OAAA,WAAA,MAAA,6BAAA;AACA,OAAA,QAAA,MAAA,YAAA;AACA,SAAA,YAAA,EAAA,cAAA,EAAA,SAAA,QAAA,uBAAA;AAEA,eAAA;AACA,cAAA;AACA,oBADA;AAEA,4BAFA;AAGA;AAHA,GADA;AAMA,MANA,kBAMA;AACA,WAAA;AACA,iBAAA,UADA;AACA;AACA,eAAA,EAFA;AAEA;AACA,kBAAA,KAHA;AAGA;AACA,iBAAA,EAJA;AAIA;AACA,kBAAA,6BALA,CAKA;;AALA,KAAA;AAOA,GAdA;AAeA,aAfA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBAgBA,WAhBA;;AAAA;AAgBA,qBAhBA;;AAAA,kBAiBA,KAAA,MAAA,CAAA,KAAA,CAAA,OAjBA;AAAA;AAAA;AAAA;;AAAA;AAAA,qBAkBA,WAlBA;;AAAA;AAkBA,sBAlBA;AAmBA,mBAAA,OAAA,aAAA,SAAA,QAAA,cAAA,SAAA,SAAA;AAnBA;AAAA;;AAAA;AAqBA,mBAAA,OAAA,GAAA,KAAA,MAAA,CAAA,KAAA,CAAA,OAAA;;AArBA;AAwBA;AACA,mBAAA,YAAA,CAAA,KAAA,OAAA,EAzBA,CA0BA;;AA1BA;AAAA,qBA2BA,aAAA,KAAA,OAAA,CA3BA;;AAAA;AA2BA,iBA3BA;AA4BA,mBAAA,SAAA,GAAA,IAAA,IAAA,CA5BA,CA6BA;;AACA,mBAAA,cAAA,CAAA,GAAA;AAEA,mBAAA,UAAA,GAAA,IAAA;;AAhCA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAkCA,SAlCA,qBAkCA;AACA,SAAA,gBAAA;AACA,GApCA;AAqCA;AACA,eADA,yBACA;AACA,WAAA,OAAA,CAAA,IAAA,CAAA;AACA,cAAA;AADA,OAAA;AAGA,KALA;AAMA,kBANA,4BAMA;AACA,UAAA,UAAA,KAAA,KAAA,CAAA,UAAA;AACA,iBAAA,YAAA;AACA,gBAAA,OAAA;AACA,OAFA,EAEA,EAFA;AAGA,KAXA;AAYA,oBAZA,8BAYA;AAAA;;AACA;AACA,qBAAA,KAAA,OAAA,EAAA,IAAA,CAAA,eAAA;AACA,YAAA,IAAA,MAAA,IAAA,CAAA,EAAA;AACA,gBAAA,SAAA,GAAA,IAAA,KAAA,CAAA,CAAA,EAAA,CAAA,CAAA;AACA,SAFA,MAEA;AACA,gBAAA,SAAA,GAAA,GAAA;AACA;AACA,OANA,EAMA,IANA,CAMA,YAAA,CAEA,CARA;AASA;AAvBA,KAwBA,aAAA,CACA,cADA,EAEA,gBAFA,CAAA,CAxBA;AArCA,CAAA","sourcesContent":["<template>\n  <div class=\"wrapper\">\n    <head-top :headTitle=\"headTitle\" @centerClick=\"centerClick\" :signinUp=\"true\"></head-top>\n    <section class=\"content_wrapper\">\n      <scroll :data=\"foodTypes\" ref=\"scrollFood\">\n        <ul class=\"food_list\">\n          <li v-for=\"(item, index) in foodTypes\" :key=\"index\">\n            <img :src='`${imgBaseUrl}${item.image_url}`' alt=\"\">\n            <p>{{item.title}}</p>\n          </li> \n        </ul>\n        <shop-list @shopListLoaded=\"shopListLoaded\"></shop-list>\n      </scroll>\n    </section>\n    <footer-guide></footer-guide>\n  </div>\n</template>\n\n<script>\n  import {mapMutations} from 'vuex'\n  import HeadTop from '../../components/head.vue'\n  import FooterGuide from '../../components/footer.vue'\n  import ShopList from './shopList'\n  import {msiteAddress, msiteFoodTypes, cityGuess} from '../../service/getData'\n\n  export default {\n    components: {\n      HeadTop,\n      FooterGuide,\n      ShopList\n    },\n    data() {\n      return {\n        headTitle: '请选择地址...', // 标题\n        geohash: '', // city页面传递过来的地址geohash\n        hasGetData: false, //是否已经获取地理位置数据，成功之后再获取商铺列表信息\n        foodTypes: [], // 食品分类列表\n        imgBaseUrl: 'https://fuss10.elemecdn.com' //图片域名地址\n      }\n    },\n    async beforeMount() {\n      const address = await cityGuess();\n      if (!this.$route.query.geohash) {\n\t\t\t  const address = await cityGuess()\n        this.geohash = `${address.latitude},${address.longitude}`\n      } else {\n        this.geohash = this.$route.query.geohash\n      }\n\n      //保存geohash 到vuex\n\t\t  this.SAVE_GEOHASH(this.geohash)\n    \t//获取位置信息\n      let res = await msiteAddress(this.geohash)\n    \tthis.headTitle = res.name\n    \t// 记录当前经度纬度\n    \tthis.RECORD_ADDRESS(res)\n\n    \tthis.hasGetData = true\n    },\n    mounted() {\n      this._initGetFoodList()\n    },\n    methods: {\n      centerClick() {\n        this.$router.push({\n          name: 'city'\n        })\n      },\n      shopListLoaded() {\n        let scrolls = this.$refs.scrollFood\n        setTimeout(() => {\n          scrolls.refresh()\n        }, 20)\n      },\n      _initGetFoodList() {\n        //获取导航食品类型列表\n       \tmsiteFoodTypes(this.geohash).then(res => {\n       \t  if (res.length >= 8) {\n            this.foodTypes = res.slice(0, 8)\n          } else {\n            this.foodTypes = res\n          }\n        }).then(() => {\n        \n        })\n      },\n      ...mapMutations([\n        'SAVE_GEOHASH',\n        'RECORD_ADDRESS'\n    \t]),\n    },\n  }\n</script>\n\n<style scoped lang=\"stylus\">\n  .wrapper\n    margin-top .44rem\n    width 100%\n    height 100%\n    .content_wrapper\n      position relative\n      width 100%\n      height calc(100% - .88rem)\n      overflow hidden\n      box-sizing border-box\n      .food_list\n        margin-bottom .2rem\n        display flex\n        flex-wrap wrap\n        width 100%\n        border-bottom 1px solid #eee\n        background-color #fff\n        li \n          display flex\n          padding .15rem 0\n          justify-content center\n          align-items center\n          flex 0 0 25%\n          flex-direction column\n          img \n            width .4rem\n            height .4rem\n          p\n            margin-top .1rem\n            font-size .14rem\n\n\n</style>"],"sourceRoot":"src/views/index"}]}