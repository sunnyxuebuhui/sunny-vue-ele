{"remainingRequest":"/Users/chenyiquan/Vue/sunny-vue-ele/node_modules/babel-loader/lib/index.js!/Users/chenyiquan/Vue/sunny-vue-ele/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/chenyiquan/Vue/sunny-vue-ele/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/chenyiquan/Vue/sunny-vue-ele/src/views/city/city.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/chenyiquan/Vue/sunny-vue-ele/src/views/city/city.vue","mtime":1539936153980},{"path":"/Users/chenyiquan/Vue/sunny-vue-ele/node_modules/cache-loader/dist/cjs.js","mtime":1539661153075},{"path":"/Users/chenyiquan/Vue/sunny-vue-ele/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/chenyiquan/Vue/sunny-vue-ele/node_modules/cache-loader/dist/cjs.js","mtime":1539661153075},{"path":"/Users/chenyiquan/Vue/sunny-vue-ele/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.array.map\";\nimport \"core-js/modules/es6.regexp.constructor\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es7.object.values\";\nimport \"core-js/modules/es6.function.name\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport ListView from './listView';\nimport { cityGuess, hotcity, groupcity } from '../../service/getData';\nexport default {\n  components: {\n    ListView: ListView\n  },\n  data: function data() {\n    return {\n      inputVal: '',\n      // 搜索值\n      guessCity: '',\n      //当前城市\n      guessCityid: '',\n      //当前城市id\n      hotcity: [],\n      //热门城市列表\n      groupcity: {},\n      //所有城市列表\n      cityList: {},\n      cityListArr: []\n    };\n  },\n  mounted: function mounted() {\n    this._initData();\n  },\n  methods: {\n    toCityDetail: function toCityDetail() {\n      this.$router.push({\n        name: 'cityDetail'\n      });\n    },\n    _initData: function _initData() {\n      var _this = this;\n\n      // 获取当前城市\n      cityGuess().then(function (res) {\n        _this.guessCity = res.name;\n        _this.guessCityid = res.id;\n      }); //获取热门城市\n\n      hotcity().then(function (res) {\n        _this.hotcity = res;\n        console.log(res);\n      }); //获取所有城市\n\n      groupcity().then(function (res) {\n        _this.cityListArr = Object.values(res);\n        _this.cityList = _this.normalizeCityList(res);\n      });\n    },\n    normalizeCityList: function normalizeCityList(map) {\n      if (!map) return {};\n      var sortobj = {\n        '热': this.hotcity\n      };\n\n      for (var i = 65; i <= 90; i++) {\n        if (map[String.fromCharCode(i)]) {\n          sortobj[String.fromCharCode(i)] = map[String.fromCharCode(i)];\n        }\n      }\n\n      console.log(1, sortobj);\n      return sortobj;\n    },\n    searchCityList: function searchCityList() {\n      var inputVal = this.inputVal;\n      var reg = new RegExp(\"^\".concat(inputVal), 'i');\n      var rsArr = [];\n      this.cityListArr.map(function (item) {\n        item.map(function (val) {\n          if (reg.test(val.name) || reg.test(val.pinyin) || reg.test(val.id)) {\n            rsArr.push(val);\n          }\n        });\n      });\n      console.log(rsArr);\n    }\n  },\n  watch: {\n    inputVal: function inputVal(newValue, oldValue) {\n      if (newValue != '') {\n        this.searchCityList();\n      }\n    }\n  }\n};",{"version":3,"sources":["city.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;AAiBA,OAAA,QAAA,MAAA,YAAA;AACA,SAAA,SAAA,EAAA,OAAA,EAAA,SAAA,QAAA,uBAAA;AAEA,eAAA;AACA,cAAA;AACA;AADA,GADA;AAIA,MAJA,kBAIA;AACA,WAAA;AACA,gBAAA,EADA;AACA;AACA,iBAAA,EAFA;AAEA;AACA,mBAAA,EAHA;AAGA;AACA,eAAA,EAJA;AAIA;AACA,iBAAA,EALA;AAKA;AACA,gBAAA,EANA;AAOA,mBAAA;AAPA,KAAA;AASA,GAdA;AAeA,SAfA,qBAeA;AACA,SAAA,SAAA;AACA,GAjBA;AAkBA,WAAA;AACA,gBADA,0BACA;AACA,WAAA,OAAA,CAAA,IAAA,CAAA;AACA,cAAA;AADA,OAAA;AAGA,KALA;AAMA,aANA,uBAMA;AAAA;;AACA;AACA,kBAAA,IAAA,CAAA,eAAA;AACA,cAAA,SAAA,GAAA,IAAA,IAAA;AACA,cAAA,WAAA,GAAA,IAAA,EAAA;AACA,OAHA,EAFA,CAOA;;AACA,gBAAA,IAAA,CAAA,eAAA;AACA,cAAA,OAAA,GAAA,GAAA;AACA,gBAAA,GAAA,CAAA,GAAA;AACA,OAHA,EARA,CAaA;;AACA,kBAAA,IAAA,CAAA,eAAA;AACA,cAAA,WAAA,GAAA,OAAA,MAAA,CAAA,GAAA,CAAA;AACA,cAAA,QAAA,GAAA,MAAA,iBAAA,CAAA,GAAA,CAAA;AACA,OAHA;AAIA,KAxBA;AAyBA,qBAzBA,6BAyBA,GAzBA,EAyBA;AACA,UAAA,CAAA,GAAA,EAAA,OAAA,EAAA;AACA,UAAA,UAAA;AACA,aAAA,KAAA;AADA,OAAA;;AAGA,WAAA,IAAA,IAAA,EAAA,EAAA,KAAA,EAAA,EAAA,GAAA,EAAA;AACA,YAAA,IAAA,OAAA,YAAA,CAAA,CAAA,CAAA,CAAA,EAAA;AACA,kBAAA,OAAA,YAAA,CAAA,CAAA,CAAA,IAAA,IAAA,OAAA,YAAA,CAAA,CAAA,CAAA,CAAA;AACA;AACA;;AACA,cAAA,GAAA,CAAA,CAAA,EAAA,OAAA;AACA,aAAA,OAAA;AACA,KArCA;AAsCA,kBAtCA,4BAsCA;AACA,UAAA,WAAA,KAAA,QAAA;AACA,UAAA,MAAA,IAAA,MAAA,YAAA,QAAA,GAAA,GAAA,CAAA;AACA,UAAA,QAAA,EAAA;AACA,WAAA,WAAA,CAAA,GAAA,CAAA,gBAAA;AACA,aAAA,GAAA,CAAA,eAAA;AACA,cAAA,IAAA,IAAA,CAAA,IAAA,IAAA,KAAA,IAAA,IAAA,CAAA,IAAA,MAAA,CAAA,IAAA,IAAA,IAAA,CAAA,IAAA,EAAA,CAAA,EAAA;AACA,kBAAA,IAAA,CAAA,GAAA;AACA;AACA,SAJA;AAKA,OANA;AAOA,cAAA,GAAA,CAAA,KAAA;AACA;AAlDA,GAlBA;AAsEA,SAAA;AACA,YADA,oBACA,QADA,EACA,QADA,EACA;AACA,UAAA,YAAA,EAAA,EAAA;AACA,aAAA,cAAA;AACA;AACA;AALA;AAtEA,CAAA","sourcesContent":["<template>\n  <div class=\"city_wrapper\">\n    <div class=\"input_wrapper\">\n      <div class=\"input_flex\">\n        <i class=\"iconfont icon-fanhui\" @click=\"$router.go(-1)\"></i>\n        <p>\n          <input type=\"text\" v-model=\"inputVal\" placeholder=\"请搜索城市名\">\n          <i class=\"iconfont icon-sousuo\"></i>\n        </p>\n        <i class=\"iconfont icon-tubiao-\" @click=\"toCityDetail\"></i>\n      </div>\n    </div>\n    <list-view :data=\"cityListArr\" :hotcity=\"hotcity\" :cityList=\"cityList\"></list-view>\n  </div>\n</template>\n\n<script>\n  import ListView from './listView'\n  import {cityGuess, hotcity, groupcity} from '../../service/getData'\n\n  export default {\n    components: {\n      ListView\n    },\n    data() {\n      return {\n        inputVal: '', // 搜索值\n        guessCity: '',   //当前城市\n        guessCityid: '', //当前城市id\n        hotcity: [],     //热门城市列表\n        groupcity: {},   //所有城市列表\n        cityList: {},\n        cityListArr: []\n      }\n    },\n    mounted() {\n      this._initData()\n    },\n    methods: {\n      toCityDetail( ) {\n        this.$router.push({\n          name: 'cityDetail'\n        })\n      },\n      _initData() {\n        // 获取当前城市\n        cityGuess().then(res => {\n          this.guessCity = res.name;\n          this.guessCityid = res.id;\n        })\n\n        //获取热门城市\n        hotcity().then(res => {\n          this.hotcity = res;\n          console.log(res)\n        })\n\n        //获取所有城市\n        groupcity().then(res => {\n          this.cityListArr = Object.values(res)\n          this.cityList = this.normalizeCityList(res)\n        })\n      },\n      normalizeCityList(map) {\n        if (!map) return {}\n        let sortobj = {\n          '热': this.hotcity\n        };\n        for (let i = 65; i <= 90; i++) {\n          if (map[String.fromCharCode(i)]) {\n            sortobj[String.fromCharCode(i)] = map[String.fromCharCode(i)];\n          }\n        }\n        console.log(1,sortobj)\n        return sortobj\n      },\n      searchCityList() {\n        let inputVal = this.inputVal\n        let reg = new RegExp(`^${inputVal}`, 'i');\n        let rsArr = []\n        this.cityListArr.map(item => {\n          item.map(val => {\n            if (reg.test(val.name) || reg.test(val.pinyin) || reg.test(val.id)) {\n              rsArr.push(val)\n            }\n          })\n        })\n        console.log(rsArr)\n      }\n    },\n    watch: {\n      inputVal(newValue, oldValue) {\n        if (newValue != '') {\n          this.searchCityList()\n        }\n      }\n    },\n  }\n</script>\n\n<style scoped lang=\"stylus\">\n  .city_wrapper\n    position fixed\n    top .55rem\n    bottom 0\n    width 100%\n    height 100%\n    overflow hidden\n    .input_wrapper\n      position fixed\n      top 0\n      left 0\n      z-index 999\n      width 100%\n      height .5rem\n      .input_flex\n        display flex\n        padding 0 .1rem\n        width 100%\n        height .5rem\n        align-items center\n        box-sizing border-box\n        background-color #fff\n        >i \n          flex 0 0 10%\n          font-size .22rem\n        >p\n          position relative\n          flex 1\n          input\n            width 100%\n            height .36rem\n            background-color #f5f5f5\n            border none\n            border-radius .1rem\n            text-indent 2.5em\n          i\n            position absolute\n            left .15rem\n            top 50%\n            transform translateY(-50%)\n</style>"],"sourceRoot":"src/views/city"}]}